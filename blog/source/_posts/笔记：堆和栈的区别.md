---
title: 笔记：堆和栈的区别

tags:
  - 杂谈
---


# 笔记：堆和栈的区别

在计算机中，堆和栈都是用于存储数据的内存区域。它们之间的**主要区别**在于**内存分配的方式**和**数据的生命周期**。

## 堆的定义

**堆**是一种**动态内存**分配的机制，通过在运行时分配和释放内存来存储数据。在堆中，数据的生命周期由程序员来控制，程序员需要负责在不再需要数据时手动释放内存，否则就可能会导致内存泄漏等问题。堆的内存分配方式是动态的，因此堆中的数据可以根据需要动态增长或缩减。

## 栈的定义

**栈**是一种**静态内存分配**的机制，通过在编译时分配内存来存储数据。在栈中，数据的生命周期是自动管理的，当一个函数或程序块执行完毕时，栈中的数据就会被自动释放。因此，在栈中创建的数据通常只在函数或程序块的生命周期内有效。栈的内存分配方式是静态的，因此栈中的数据大小是固定的。

## 堆和栈的区别

总的来说，堆和栈各有优劣。

**堆具有灵活性和动态性，但需要程序员手动管理内存，容易导致内存泄漏等问题。**

**栈具有自动管理内存的优点，但数据的生命周期受限于函数或程序块的生命周期，并且大小是固定的。**

在实际编程中，我们需要根据不同的需求来选择使用堆还是栈来存储数据。

## 全局变量与堆变量的区别

**全局变量**和在**堆上创建的变量**有些相似，它们**都是在程序运行时分配的内存空间**。但是它们的**内存分配**和**释放方式**是**不同的**。

**全局变量**是在程序编译时分配内存的，它们的**生命周期贯穿整个程序运行的周期**，直到程序退出才会被释放。全局变量的内**存分配和释放是自动管理**的，程序员不需要手动管理它们。

**堆上创建的变量**是在程序运行时**动态分配的内存空间**，它们的**生命周期由程序员手动管理**。程序员需要手动分配内存空间，并在不需要时手动释放内存空间。如果程序员没有释放堆上的变量，就会导致内存泄漏的问题。

因此，尽管全局变量和堆上的变量都是在程序运行时动态分配的内存空间，但是它们的内存分配和释放方式是不同的，程序员需要根据实际需求进行选择。

#### 总结

全局变量是在程序启动时就被分配在内存中的，直到程序结束才被释放。而堆变量是在程序运行时动态分配的，需要手动释放，否则会出现内存泄漏的问题。
